name: ğŸš€ Release & Deploy

on:
  push:
    tags:
      - 'v*'
  workflow_dispatch:
    inputs:
      version:
        description: 'Release Version (e.g., 2025.11.11)'
        required: true
        type: string
      release_type:
        description: 'Release Type'
        required: true
        default: 'minor'
        type: choice
        options:
          - patch
          - minor
          - major
      prerelease:
        description: 'Pre-release?'
        required: false
        default: false
        type: boolean
      generate_builds:
        description: 'Generate build artifacts?'
        required: false
        default: true
        type: boolean
      deploy_docs:
        description: 'Deploy documentation?'
        required: false
        default: true
        type: boolean

env:
  PYTHON_VERSION: '3.11'

permissions:
  contents: write
  issues: write
  pull-requests: write
  pages: write
  id-token: write

jobs:
  validate-release:
    name: ğŸ” Validate Release
    runs-on: ubuntu-latest
    outputs:
      version: ${{ steps.validate.outputs.version }}
      tag_name: ${{ steps.validate.outputs.tag_name }}
      is_prerelease: ${{ steps.validate.outputs.is_prerelease }}
    
    steps:
    - uses: actions/checkout@v4
      with:
        fetch-depth: 0
    
    - name: Get version from tag or input
      id: validate
      run: |
        if [[ "${{ github.event_name }}" == "push" && "${{ github.ref }}" == refs/tags/v* ]]; then
          # Extract version from git tag
          VERSION="${{ github.ref }}"
          VERSION=${VERSION#refs/tags/v}
          IS_PRERELEASE="false"
        else
          # Use workflow input
          VERSION="${{ github.event.inputs.version }}"
          IS_PRERELEASE="${{ github.event.inputs.prerelease }}"
        fi
        
        # Validate version format (YYYY.MM.DD or YYYY.MM.DD.PATCH)
        if [[ ! "$VERSION" =~ ^[0-9]{4}\.[0-9]{1,2}\.[0-9]{1,2}(\.[0-9]+)?$ ]]; then
          echo "âŒ Invalid version format: $VERSION"
          echo "Expected format: YYYY.MM.DD or YYYY.MM.DD.PATCH"
          exit 1
        fi
        
        # Check if tag already exists (only for manual releases)
        if [[ "${{ github.event_name }}" == "workflow_dispatch" ]]; then
          if git tag -l | grep -q "^v$VERSION$"; then
            echo "âŒ Tag v$VERSION already exists"
            exit 1
          fi
        fi
        
        echo "version=$VERSION" >> $GITHUB_OUTPUT
        echo "tag_name=v$VERSION" >> $GITHUB_OUTPUT
        echo "is_prerelease=$IS_PRERELEASE" >> $GITHUB_OUTPUT
        
        echo "âœ… Release validation passed"
        echo "ğŸ“¦ Version: $VERSION"
        echo "ğŸ·ï¸ Tag: v$VERSION"
        echo "ğŸš§ Pre-release: $IS_PRERELEASE"

  run-full-tests:
    name: ğŸ§ª Full Test Suite
    uses: ./.github/workflows/test.yml
    secrets: inherit
    with:
      run_extended_tests: true

  update-version:
    name: ğŸ“ Update Version & Changelog
    runs-on: ubuntu-latest
    needs: [validate-release, run-full-tests]
    if: github.event_name == 'workflow_dispatch'
    outputs:
      changelog_content: ${{ steps.changelog.outputs.content }}
    
    steps:
    - uses: actions/checkout@v4
      with:
        token: ${{ secrets.GITHUB_TOKEN }}
        fetch-depth: 0
    
    - name: Update version.py
      run: |
        VERSION="${{ needs.validate-release.outputs.version }}"
        echo "Updating version.py to $VERSION"
        
        cat > version.py << EOF
        #!/usr/bin/env python3
        # -*- coding: utf-8 -*-
        """
        Master Search - Version Management
        Single source of truth for version information

        Author: Loony2392
        Email: b.kolb@loony-tech.de
        """

        # VERSION INFORMATION - Update only here!
        VERSION = "$VERSION"
        AUTHOR = "Loony2392"
        EMAIL = "b.kolb@loony-tech.de"
        COMPANY = "LOONY-TECH"
        YEAR = "$(date +%Y)"
        GITHUB = "https://github.com/Loony2392/master-search"

        # Build version string
        VERSION_STRING = f"Master Search v{VERSION}"
        FULL_VERSION = f"{VERSION_STRING} (c) {YEAR} {COMPANY}"
        EOF
        
        echo "âœ… Version updated to $VERSION"
    
    - name: Generate changelog entry
      id: changelog
      run: |
        VERSION="${{ needs.validate-release.outputs.version }}"
        DATE=$(date +"%d. %B %Y")
        
        # Extract commits since last release
        LAST_TAG=$(git describe --tags --abbrev=0 2>/dev/null || echo "")
        if [ -n "$LAST_TAG" ]; then
          COMMITS=$(git log ${LAST_TAG}..HEAD --oneline --pretty=format:"- %s (%h)")
        else
          COMMITS=$(git log --oneline --pretty=format:"- %s (%h)" | head -20)
        fi
        
        # Generate changelog content
        CHANGELOG_ENTRY=$(cat << EOF
        ## [$VERSION] - $DATE

        ### ğŸ†• New Features & Improvements
        $COMMITS

        ### ğŸ“¦ Build Information
        - **Release Type:** ${{ github.event.inputs.release_type }}
        - **Pre-release:** ${{ github.event.inputs.prerelease }}
        - **Generated:** $(date -u +"%Y-%m-%d %H:%M:%S UTC")
        - **Commit:** $(git rev-parse --short HEAD)

        ---

        EOF
        )
        
        # Save changelog content for later use
        echo "content<<EOF" >> $GITHUB_OUTPUT
        echo "$CHANGELOG_ENTRY" >> $GITHUB_OUTPUT
        echo "EOF" >> $GITHUB_OUTPUT
        
        echo "âœ… Changelog prepared"
    
    - name: Commit version changes
      if: github.event_name == 'workflow_dispatch'
      run: |
        git config user.name "github-actions[bot]"
        git config user.email "41898282+github-actions[bot]@users.noreply.github.com"
        
        git add version.py
        git commit -m "ğŸ”– Release v${{ needs.validate-release.outputs.version }}

        - Update version to ${{ needs.validate-release.outputs.version }}
        - Release type: ${{ github.event.inputs.release_type }}
        - Pre-release: ${{ github.event.inputs.prerelease }}"
        
        git push origin main
        
        echo "âœ… Version changes committed and pushed"

  build-artifacts:
    name: ğŸ—ï¸ Build Release Artifacts
    runs-on: ${{ matrix.os }}
    needs: [validate-release, update-version]
    if: always() && needs.validate-release.result == 'success' && (github.event.inputs.generate_builds == 'true' || github.event_name == 'push')
    strategy:
      fail-fast: false
      matrix:
        include:
          - os: windows-latest
            artifact_name: windows-exe
            build_type: "Windows MSI"
          - os: macos-latest  
            artifact_name: macos-dmg
            build_type: "macOS DMG"
          - os: ubuntu-latest
            artifact_name: linux-source
            build_type: "Linux Source"
    
    steps:
    - uses: actions/checkout@v4
      with:
        ref: main  # Use updated version for manual releases
    
    - name: Set up Python ${{ env.PYTHON_VERSION }}
      uses: actions/setup-python@v4
      with:
        python-version: ${{ env.PYTHON_VERSION }}
    
    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt
    
    - name: Build Windows Installer with Inno Setup
      if: matrix.os == 'windows-latest'
      shell: pwsh
      run: |
        echo "ğŸ—ï¸ Building Windows Installer with Inno Setup..."
        
        # Install PyInstaller and build executables
        echo "ğŸ“¦ Building executables with PyInstaller..."
        pip install PyInstaller>=6.1.0
        
        python -m PyInstaller scripts/gui.spec
        python -m PyInstaller scripts/cli.spec
        
        if (-not (Test-Path "dist/MasterSearch.exe")) {
          Write-Error "âŒ GUI executable not found"
          exit 1
        }
        if (-not (Test-Path "dist/MasterSearchCLI.exe")) {
          Write-Error "âŒ CLI executable not found"
          exit 1
        }
        
        echo "âœ… Executables built successfully"
        
        # Download and install Inno Setup
        echo "ğŸ“¥ Downloading Inno Setup..."
        $innoSetupUrl = "https://jrsoftware.org/download.php/is-unicode.exe"
        $innoSetupInstaller = "$env:TEMP\InnoSetup.exe"
        
        # Try direct download
        try {
          Invoke-WebRequest -Uri $innoSetupUrl -OutFile $innoSetupInstaller -ErrorAction SilentlyContinue
        } catch {
          # Fallback to alternative URL
          $innoSetupUrl = "https://files.jrsoftware.org/is/6/innosetup-6.2.2.exe"
          try {
            Invoke-WebRequest -Uri $innoSetupUrl -OutFile $innoSetupInstaller
          } catch {
            Write-Host "âš ï¸ Could not download Inno Setup. Trying system installation..."
            # Check if already installed
            if (-not (Get-Command iscc.exe -ErrorAction SilentlyContinue)) {
              Write-Error "âŒ Inno Setup not available. Falling back to ZIP package."
              exit 0  # Continue with ZIP as fallback
            }
          }
        }
        
        # Install Inno Setup if downloaded
        if (Test-Path $innoSetupInstaller) {
          echo "âš™ï¸ Installing Inno Setup..."
          & $innoSetupInstaller /VERYSILENT /SUPPRESSMSGBOXES /NORESTART
          Start-Sleep -Seconds 5
        }
        
        # Build MSI using Inno Setup
        if (Get-Command iscc.exe -ErrorAction SilentlyContinue) {
          echo "ğŸ”¨ Building MSI with Inno Setup..."
          
          # Create release_builds directory
          New-Item -ItemType Directory -Force -Path "release_builds" | Out-Null
          
          # Compile Inno Setup script
          iscc.exe scripts/MasterSearch.iss
          
          if ($LASTEXITCODE -eq 0) {
            # Find and rename the generated EXE (Inno Setup creates EXE not MSI)
            $setupExe = Get-ChildItem -Path "release_builds" -Filter "Master_Search_*.exe" | Select-Object -First 1
            if ($setupExe) {
              $msiName = "Master_Search_v${{ needs.validate-release.outputs.version }}_Windows.exe"
              Rename-Item -Path $setupExe.FullName -NewName $msiName
              $size = [math]::Round((Get-Item "release_builds/$msiName").Length / 1MB, 2)
              Write-Host "âœ… Windows installer created: $msiName"
              Write-Host "ğŸ“¦ Size: $size MB"
              
              # Create SHA256 checksum
              $hash = (Get-FileHash "release_builds/$msiName" -Algorithm SHA256).Hash
              Add-Content -Path "release_builds/$msiName.sha256" -Value "$hash  $msiName"
              Write-Host "ğŸ” SHA256: $hash"
            } else {
              Write-Error "âŒ Installer EXE not found after compilation"
              Get-ChildItem release_builds
              exit 1
            }
          } else {
            Write-Error "âŒ Inno Setup compilation failed with exit code $LASTEXITCODE"
            exit 1
          }
        } else {
          Write-Host "âš ï¸ Inno Setup not available. Falling back to ZIP package..."
          
          # Fallback: Create ZIP installer package
          echo "ğŸ“¦ Creating installer package (ZIP)..."
          python scripts/create_installer_package.py
          
          # Find and rename ZIP
          $zipFile = Get-ChildItem -Path "release_builds" -Filter "MasterSearch_v*.zip" | Select-Object -First 1
          if ($zipFile) {
            $newName = "Master_Search_v${{ needs.validate-release.outputs.version }}_Windows.zip"
            Rename-Item -Path $zipFile.FullName -NewName $newName
            Write-Host "âœ… Windows installer package created: $newName"
            
            # Create SHA256 checksum
            $hash = (Get-FileHash "release_builds/$newName" -Algorithm SHA256).Hash
            Add-Content -Path "release_builds/$newName.sha256" -Value "$hash  $newName"
          }
        }
    
    - name: Build macOS DMG
      if: matrix.os == 'macos-latest'
      run: |
        echo "ğŸ Building macOS DMG package..."
        
        # Install macOS build dependencies
        pip install py2app
        pip install dmgbuild || true  # Optional for advanced DMG creation
        
        # Create app bundle directory structure
        mkdir -p release_builds
        APP_NAME="Master Search"
        APP_DIR="release_builds/${APP_NAME}.app"
        
        # Create basic app bundle structure
        mkdir -p "${APP_DIR}/Contents/MacOS"
        mkdir -p "${APP_DIR}/Contents/Resources"
        
        # Create Info.plist
        cat > "${APP_DIR}/Contents/Info.plist" << 'EOF'
        <?xml version="1.0" encoding="UTF-8"?>
        <!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
        <plist version="1.0">
        <dict>
            <key>CFBundleExecutable</key>
            <string>master_search</string>
            <key>CFBundleIdentifier</key>
            <string>de.loony-tech.master-search</string>
            <key>CFBundleName</key>
            <string>Master Search</string>
            <key>CFBundleVersion</key>
            <string>${{ needs.validate-release.outputs.version }}</string>
            <key>CFBundleShortVersionString</key>
            <string>${{ needs.validate-release.outputs.version }}</string>
            <key>CFBundlePackageType</key>
            <string>APPL</string>
        </dict>
        </plist>
        EOF
        
        # Create launcher script
        cat > "${APP_DIR}/Contents/MacOS/master_search" << 'EOF'
        #!/bin/bash
        cd "$(dirname "$0")/../Resources"
        python3 gui_main.py
        EOF
        chmod +x "${APP_DIR}/Contents/MacOS/master_search"
        
        # Copy Python sources to Resources
        cp -r *.py "${APP_DIR}/Contents/Resources/" || true
        cp -r locales "${APP_DIR}/Contents/Resources/" || true
        cp -r media "${APP_DIR}/Contents/Resources/" || true
        cp requirements.txt "${APP_DIR}/Contents/Resources/" || true
        
        # Create DMG
        DMG_NAME="Master_Search_v${{ needs.validate-release.outputs.version }}_macOS.dmg"
        
        # Create temporary DMG
        hdiutil create -size 100m -fs HFS+ -volname "Master Search" temp.dmg
        
        # Mount and copy app
        hdiutil attach temp.dmg -mountpoint /Volumes/temp_mount
        cp -r "${APP_DIR}" /Volumes/temp_mount/
        
        # Create Applications symlink
        ln -s /Applications /Volumes/temp_mount/Applications
        
        # Unmount and convert to final DMG
        hdiutil detach /Volumes/temp_mount
        hdiutil convert temp.dmg -format UDZO -o "release_builds/${DMG_NAME}"
        rm temp.dmg
        
        echo "âœ… macOS DMG created: ${DMG_NAME}"
        echo "ğŸ“¦ Size: $(du -h "release_builds/${DMG_NAME}" | cut -f1)"
    
    - name: Build Linux Source & AppImage
      if: matrix.os == 'ubuntu-latest'
      run: |
        echo "ğŸ§ Building Linux packages..."
        mkdir -p release_builds
        
        # Install build dependencies
        pip install build setuptools wheel
        
        # 1. Create source distribution
        echo "ğŸ“¦ Creating source distribution..."
        python -m build --sdist
        if [ -f dist/*.tar.gz ]; then
          cp dist/*.tar.gz "release_builds/Master_Search_v${{ needs.validate-release.outputs.version }}_Source.tar.gz"
          echo "âœ… Source tarball created"
        fi
        
        # 2. Create standalone zip
        echo "ğŸ“¦ Creating standalone zip..."
        zip -r "release_builds/Master_Search_v${{ needs.validate-release.outputs.version }}_Source.zip" . \
          -x "*.git*" "*/__pycache__/*" "*/build/*" "*/dist/*" "*.pyc" "*.pyo" \
             "*/release_builds/*" "*/.pytest_cache/*" "*/.coverage*"
        echo "âœ… Standalone zip created"
        
        # 3. Create Debian package structure (basic)
        echo "ğŸ“¦ Creating Debian package structure..."
        DEB_DIR="master-search-${{ needs.validate-release.outputs.version }}"
        mkdir -p "${DEB_DIR}/DEBIAN"
        mkdir -p "${DEB_DIR}/usr/local/bin"
        mkdir -p "${DEB_DIR}/usr/share/applications"
        mkdir -p "${DEB_DIR}/usr/share/master-search"
        
        # Create control file
        cat > "${DEB_DIR}/DEBIAN/control" << 'EOF'
        Package: master-search
        Version: ${{ needs.validate-release.outputs.version }}
        Section: utils
        Priority: optional
        Architecture: all
        Depends: python3 (>= 3.8), python3-tk
        Maintainer: Loony2392 <b.kolb@loony-tech.de>
        Description: Professional file search tool
         Master Search is a powerful desktop tool for full-text file system search
         with advanced filtering options and beautiful HTML reports.
        EOF
        
        # Copy application files
        cp -r *.py "${DEB_DIR}/usr/share/master-search/"
        cp -r locales "${DEB_DIR}/usr/share/master-search/" || true
        cp -r media "${DEB_DIR}/usr/share/master-search/" || true
        cp requirements.txt "${DEB_DIR}/usr/share/master-search/"
        
        # Create launcher script
        cat > "${DEB_DIR}/usr/local/bin/master-search" << 'EOF'
        #!/bin/bash
        cd /usr/share/master-search
        python3 gui_main.py "$@"
        EOF
        chmod +x "${DEB_DIR}/usr/local/bin/master-search"
        
        # Create desktop file
        cat > "${DEB_DIR}/usr/share/applications/master-search.desktop" << 'EOF'
        [Desktop Entry]
        Name=Master Search
        Comment=Professional file search tool
        Exec=master-search
        Icon=master-search
        Terminal=false
        Type=Application
        Categories=Utility;FileTools;
        EOF
        
        # Build DEB package
        dpkg-deb --build "${DEB_DIR}" "release_builds/Master_Search_v${{ needs.validate-release.outputs.version }}_Linux.deb"
        echo "âœ… Debian package created"
        
        # 4. Create portable Linux archive
        echo "ğŸ“¦ Creating portable Linux archive..."
        tar -czf "release_builds/Master_Search_v${{ needs.validate-release.outputs.version }}_Linux_Portable.tar.gz" \
          --exclude=".git*" --exclude="__pycache__" --exclude="build" --exclude="dist" \
          --exclude="release_builds" --exclude=".pytest_cache" --exclude=".coverage*" \
          *.py locales/ media/ requirements.txt README.md LICENSE || true
        
        echo "âœ… All Linux packages created"
        echo "ğŸ“Š Package sizes:"
        ls -lh release_builds/ | grep Master_Search
    
    - name: Upload build artifacts
      uses: actions/upload-artifact@v3
      with:
        name: ${{ matrix.artifact_name }}
        path: release_builds/
        retention-days: 30

  create-release:
    name: ğŸ‰ Create GitHub Release
    runs-on: ubuntu-latest
    needs: [validate-release, build-artifacts]
    if: always() && needs.validate-release.result == 'success'
    
    steps:
    - uses: actions/checkout@v4
      with:
        ref: main
        fetch-depth: 0
    
    - name: Download all artifacts
      if: needs.build-artifacts.result == 'success'
      uses: actions/download-artifact@v3
      with:
        path: ./release_artifacts
    
    - name: List and organize artifacts
      if: needs.build-artifacts.result == 'success'
      run: |
        echo "ğŸ“¦ Downloaded build artifacts:"
        find ./release_artifacts -type f | while read file; do
          echo "  ğŸ“ $file ($(du -h "$file" 2>/dev/null | cut -f1 || echo '0B'))"
        done
        
        echo "ğŸ”§ Organizing artifacts..."
        mkdir -p ./organized_artifacts
        
        # Copy all build artifacts to organized directory
        find ./release_artifacts -name "*.msi" -exec cp {} ./organized_artifacts/ \;
        find ./release_artifacts -name "*.dmg" -exec cp {} ./organized_artifacts/ \;
        find ./release_artifacts -name "*.zip" -exec cp {} ./organized_artifacts/ \;
        find ./release_artifacts -name "*.tar.gz" -exec cp {} ./organized_artifacts/ \;
        find ./release_artifacts -name "*.deb" -exec cp {} ./organized_artifacts/ \;
        
        echo "âœ… Final artifacts for release:"
        ls -lah ./organized_artifacts/ || echo "No organized artifacts found"
    
    - name: Create Git tag
      if: github.event_name == 'workflow_dispatch'
      run: |
        git config user.name "github-actions[bot]"
        git config user.email "41898282+github-actions[bot]@users.noreply.github.com"
        
        git tag -a "${{ needs.validate-release.outputs.tag_name }}" -m "Master Search ${{ needs.validate-release.outputs.version }}

        ğŸ¯ Release Highlights:
        - Professional file search tool
        - Complete German localization
        - Modern animation system
        - Cross-platform support (Windows/macOS/Linux)

        ğŸ“¦ Build Information:
        - Version: ${{ needs.validate-release.outputs.version }}
        - Release Type: ${{ github.event.inputs.release_type }}
        - Pre-release: ${{ github.event.inputs.prerelease }}
        - Build Date: $(date -u +"%Y-%m-%d %H:%M:%S UTC")

        ğŸš€ Ready for production use!"
        
        git push origin "${{ needs.validate-release.outputs.tag_name }}"
        
        echo "âœ… Git tag created and pushed"
    
    - name: Prepare release notes
      id: release_notes
      run: |
        VERSION="${{ needs.validate-release.outputs.version }}"
        
        cat > release_notes.md << 'EOF'
        # ğŸ‰ Master Search v${{ needs.validate-release.outputs.version }}

        ## ğŸ“‹ Ãœbersicht / Overview

        **Deutsch:**
        Professionelles Datei-Suchprogramm mit vollstÃ¤ndiger deutscher Lokalisierung und modernen Animationen.

        **English:**
        Professional file search tool with complete German localization and modern animations.

        ## ğŸš€ Hauptfeatures / Key Features

        - âœ… **Complete German GUI** - 138+ UI elements translated / VollstÃ¤ndige deutsche BenutzeroberflÃ¤che
        - âœ… **Modern Animations** - Smooth 60 FPS loading effects / Moderne 60 FPS Ladeanimationen  
        - âœ… **Cross-Platform** - Native Windows, macOS, Linux support / PlattformÃ¼bergreifend
        - âœ… **Professional Reports** - HTML reports with statistics / Professionelle HTML-Reports
        - âœ… **High Performance** - Multi-threaded search engine / Hochleistungs-Suchmaschine

        ## ğŸ“¦ Downloads

        Choose your platform / WÃ¤hlen Sie Ihre Plattform:

        ### Windows
        - `Master_Search_v${{ needs.validate-release.outputs.version }}_Windows.msi` - **Windows Installer (empfohlen/recommended)**

        ### macOS
        - `Master_Search_v${{ needs.validate-release.outputs.version }}_macOS.dmg` - **macOS DMG Package**

        ### Linux
        - `Master_Search_v${{ needs.validate-release.outputs.version }}_Linux.deb` - **Debian/Ubuntu Package**
        - `Master_Search_v${{ needs.validate-release.outputs.version }}_Linux_Portable.tar.gz` - **Portable Linux Archive**

        ### Source Code
        - `Master_Search_v${{ needs.validate-release.outputs.version }}_Source.tar.gz` - **Python Source Distribution**
        - `Master_Search_v${{ needs.validate-release.outputs.version }}_Source.zip` - **Source ZIP Archive**

        ## ğŸš€ Installation / Quick Start

        ### Windows
        1. Download `Master_Search_v${{ needs.validate-release.outputs.version }}_Windows.msi`
        2. Run installer as administrator
        3. Follow installation wizard
        4. Launch from Start Menu

        ### macOS  
        1. Download `Master_Search_v${{ needs.validate-release.outputs.version }}_macOS.dmg`
        2. Mount DMG file
        3. Drag "Master Search.app" to Applications folder
        4. Launch from Applications

        ### Linux (Debian/Ubuntu)
        ```bash
        # Download and install
        sudo dpkg -i Master_Search_v${{ needs.validate-release.outputs.version }}_Linux.deb
        sudo apt-get install -f  # Fix dependencies if needed
        master-search
        ```

        ### Linux (Portable)
        ```bash
        # Extract and run
        tar -xzf Master_Search_v${{ needs.validate-release.outputs.version }}_Linux_Portable.tar.gz
        cd master-search-*
        pip3 install -r requirements.txt
        python3 gui_main.py
        ```

        ### From Source
        ```bash
        # Extract source
        tar -xzf Master_Search_v${{ needs.validate-release.outputs.version }}_Source.tar.gz
        cd master-search-*
        
        # Install dependencies
        pip install -r requirements.txt
        
        # Run application
        python gui_main.py
        ```

        ## ğŸ“– Documentation / Dokumentation

        - **User Guide (English)**: [USER_GUIDE_EN.md](https://github.com/Loony2392/master-search/blob/main/USER_GUIDE_EN.md)
        - **Benutzerhandbuch (Deutsch)**: [USER_GUIDE_DE.md](https://github.com/Loony2392/master-search/blob/main/USER_GUIDE_DE.md)
        - **Guide d'utilisateur (FranÃ§ais)**: [USER_GUIDE_FR.md](https://github.com/Loony2392/master-search/blob/main/USER_GUIDE_FR.md)

        ## ğŸ†• What's New / Neue Features

        This release includes major improvements to the user experience and cross-platform compatibility.

        ## ğŸ› Bug Reports / Fehlerberichte

        - **English**: [Report bugs on GitHub](https://github.com/Loony2392/master-search/issues)
        - **Deutsch**: [Fehler auf GitHub melden](https://github.com/Loony2392/master-search/issues)

        ## ğŸ’» System Requirements / Systemanforderungen

        ### Minimum
        - **Windows**: Windows 10+ (64-bit)
        - **macOS**: macOS 10.15+ (Catalina)
        - **Linux**: Ubuntu 18.04+, Python 3.8+

        ### Recommended  
        - **RAM**: 4 GB+ for large file searches
        - **Storage**: 100 MB free space
        - **Python**: 3.8+ (for source installation)

        ---

        **Developed by / Entwickelt von:** Loony2392  
        **Contact / Kontakt:** b.kolb@loony-tech.de  
        **Company / Firma:** LOONY-TECH  

        Â© 2025 LOONY-TECH - All rights reserved / Alle Rechte vorbehalten
        EOF
        
        echo "âœ… Release notes prepared"
    
    - name: Create GitHub Release with all artifacts
      uses: softprops/action-gh-release@v1
      with:
        tag_name: ${{ needs.validate-release.outputs.tag_name }}
        name: Master Search v${{ needs.validate-release.outputs.version }}
        body_path: release_notes.md
        prerelease: ${{ needs.validate-release.outputs.is_prerelease }}
        draft: false
        files: |
          ./organized_artifacts/*
          ./release_artifacts/**/*.msi
          ./release_artifacts/**/*.dmg
          ./release_artifacts/**/*.zip
          ./release_artifacts/**/*.tar.gz
          ./release_artifacts/**/*.deb
        generate_release_notes: false
        fail_on_unmatched_files: false
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

  deploy-documentation:
    name: ğŸ“š Deploy Documentation
    runs-on: ubuntu-latest
    needs: [validate-release, create-release]
    if: github.event.inputs.deploy_docs == 'true' || github.event_name == 'push'
    
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    
    steps:
    - uses: actions/checkout@v4
      with:
        ref: main
    
    - name: Setup Pages
      uses: actions/configure-pages@v3
    
    - name: Build documentation
      run: |
        mkdir -p _site
        
        # Copy documentation files
        cp README.md _site/
        cp *.md _site/
        
        # Create index page
        cat > _site/index.html << 'EOF'
        <!DOCTYPE html>
        <html lang="de">
        <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>Master Search v${{ needs.validate-release.outputs.version }} - Documentation</title>
            <style>
                body { 
                  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif; 
                  margin: 40px; 
                  background: #f6f8fa;
                }
                .header { 
                  text-align: center; 
                  margin-bottom: 40px; 
                  padding: 20px;
                  background: white;
                  border-radius: 8px;
                  box-shadow: 0 1px 3px rgba(0,0,0,0.1);
                }
                .version { color: #666; }
                .links { 
                  display: grid; 
                  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); 
                  gap: 20px; 
                }
                .card { 
                  background: white;
                  border: 1px solid #ddd; 
                  padding: 20px; 
                  border-radius: 8px;
                  box-shadow: 0 1px 3px rgba(0,0,0,0.1);
                }
                .card h3 { margin-top: 0; color: #0366d6; }
                .card a { text-decoration: none; color: #0366d6; }
                .card a:hover { text-decoration: underline; }
            </style>
        </head>
        <body>
            <div class="header">
                <h1>ğŸ” Master Search</h1>
                <p class="version">Version ${{ needs.validate-release.outputs.version }}</p>
                <p>Professional File Search Tool with German Localization</p>
            </div>
            <div class="links">
                <div class="card">
                    <h3>ğŸ“– User Guides</h3>
                    <p><a href="USER_GUIDE_DE.md">ğŸ‡©ğŸ‡ª Deutsches Benutzerhandbuch</a></p>
                    <p><a href="USER_GUIDE_EN.md">ğŸ‡ºğŸ‡¸ English User Guide</a></p>
                    <p><a href="USER_GUIDE_FR.md">ğŸ‡«ğŸ‡· Guide d'utilisateur FranÃ§ais</a></p>
                </div>
                <div class="card">
                    <h3>ğŸš€ Release Information</h3>
                    <p><a href="CHANGELOG.md">ğŸ“‹ Changelog</a></p>
                    <p><a href="README.md">ğŸ“– README</a></p>
                    <p><a href="https://github.com/Loony2392/master-search/releases/latest">ğŸ“¦ Download Latest</a></p>
                </div>
                <div class="card">
                    <h3>ğŸ“Š Development</h3>
                    <p><a href="https://github.com/Loony2392/master-search">ğŸ’» GitHub Repository</a></p>
                    <p><a href="https://github.com/Loony2392/master-search/issues">ğŸ› Bug Reports</a></p>
                    <p><a href="https://github.com/Loony2392/master-search/discussions">ğŸ’¬ Discussions</a></p>
                </div>
            </div>
        </body>
        </html>
        EOF
        
        echo "âœ… Documentation site built"
    
    - name: Upload Pages artifact
      uses: actions/upload-pages-artifact@v2
      with:
        path: _site
    
    - name: Deploy to GitHub Pages
      id: deployment
      uses: actions/deploy-pages@v2

  notification:
    name: ğŸ“§ Release Notification
    runs-on: ubuntu-latest
    needs: [validate-release, create-release]
    if: always() && needs.create-release.result == 'success'
    
    steps:
    - name: Send success notification
      run: |
        echo "ğŸ‰ RELEASE SUCCESSFUL! ğŸ‰"
        echo ""
        echo "âœ… Version: ${{ needs.validate-release.outputs.version }}"
        echo "âœ… Tag: ${{ needs.validate-release.outputs.tag_name }}" 
        echo "âœ… Pre-release: ${{ needs.validate-release.outputs.is_prerelease }}"
        echo "âœ… Release URL: https://github.com/Loony2392/master-search/releases/tag/${{ needs.validate-release.outputs.tag_name }}"
        echo ""
        echo "ğŸ¯ Master Search v${{ needs.validate-release.outputs.version }} is now available!"
        echo "ğŸŒ Download: https://github.com/Loony2392/master-search/releases/latest"
        echo "ğŸ“š Documentation: https://loony2392.github.io/master-search/"
        echo ""
        echo "ğŸš€ Ready for production use!"
